<!doctype html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Content Manager</title>
        <link rel="stylesheet" href="https://liquid-theme.netlify.app/admin/ui-cms.css"/>
        <link rel="stylesheet" href="https://unpkg.com/netlify-cms@^1.0.0/dist/cms.css"/>
    </head>
    <body>
        <script src="https://unpkg.com/@ncwidgets/netlify-cms@^0.7.0/dist/netlify-cms.js"></script>
        <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
        <script>
          import CMS from 'netlify-cms-app';
          import { Widget as FileRelationWidget } from '@ncwidgets/file-relation';
          cms.registerWidget(FileRelationWidget);
          cms.init();
        </script>
        <script>
          var AgendaPreview = createClass({
            render: function() {
              var entry = this.props.entry;
              var lieu = entry.getIn(['data', 'lieu']);
              return h('div', {class: 'main' },
                h('div',  {class: 'slider' }),
                h('div',  {class: 'container grid-content' },
                  h('section',  {class: 'content-slug place' },
                    h('h3', {}, this.props.widgetsFor('lieu').getIn(['data', 'titleLieu'])))))
              );
            }
          });

          CMS.registerPreviewTemplate("agenda", AgendaPreview);
          CMS.registerPreviewStyle("https://liquid-theme.netlify.app/admin/ui-panel.css");
        </script>
        <script>
          var GeneralPreview = createClass({
            // Object fields are simpler than lists - instead of `widgetsFor` returning
            // an array of objects, it returns a single object. Accessing the shape of
            // that object is the same as the shape of objects returned for list fields:
            //
            // {
            //   data: { front_limit: 0, author: 'Chris' },
            //   widgets: { front_limit: (<WidgetComponent>), author: (WidgetComponent>)}
            // }
            render: function() {
              var entry = this.props.entry;
              var title = entry.getIn(['data', 'site_title']);
              var posts = entry.getIn(['data', 'posts']);
              return h('div', {},
                h('h1', {}, title),
                h('dl', {},
                  h('dt', {}, 'Default Author'),
                  h('dd', {}, this.props.widgetsFor('posts').getIn(['data', 'author']) || 'None'),
                )
              );
            }
          });

          CMS.registerPreviewTemplate("general", GeneralPreview);
        </script>
    </body>
</html>
